# harfbuzz
# version 1.1.0

# Notes for building harfbuzz with another build system

# Before compiling harfbuzz, ragel must be
# run on the *.rl files to generate headers
# used by some of the source files:
# $ ragel -e -F1 -o hb-buffer-deserialize-json.hh hb-buffer-deserialize-json.rl
# $ ragel -e -F1 -o hb-buffer-deserialize-text.hh hb-buffer-deserialize-text.rl
# $ ragel -e -F1 -o hb-ot-shape-complex-indic-machine.hh hb-ot-shape-complex-indic-machine.rl
# $ ragel -e -F1 -o hb-ot-shape-complex-myanmar-machine.hh hb-ot-shape-complex-myanmar-machine.rl
# $ ragel -e -F1 -o hb-ot-shape-complex-use-machine.hh hb-ot-shape-complex-use-machine.rl
#
# Harfbuzz also uses automake to generate hb-version.h, so
# this should be generated by running ./configure from the
# dev machine in the original harfbuzz directory and then
# copied over to the sources used to build with qmake

PATH_HARFBUZZ = $${PWD}
PATH_HARFBUZZ_UCDN = $${PATH_HARFBUZZ}/hb-ucdn

INCLUDEPATH += $${PATH_HARFBUZZ}
INCLUDEPATH += $${PATH_HARFBUZZ_UCDN}

# no multithreading (android has this enabled flag
# set for some reason) so we leave it on
DEFINES += HB_NO_MT

DEFINES += HAVE_OT # opentype
DEFINES += HAVE_FREETYPE
DEFINES += HAVE_UCDN

# TODO what is HAVE_FALLBACK for?
#DEFINES += HAVE_FALLBACK

# TODO compiler flags

# harfbuzz core
SOURCES += \
        $${PATH_HARFBUZZ}/hb-blob.cc \
        $${PATH_HARFBUZZ}/hb-buffer-serialize.cc \
        $${PATH_HARFBUZZ}/hb-buffer.cc \
        $${PATH_HARFBUZZ}/hb-common.cc \
        $${PATH_HARFBUZZ}/hb-face.cc \
        $${PATH_HARFBUZZ}/hb-font.cc \
        $${PATH_HARFBUZZ}/hb-ot-tag.cc \
        $${PATH_HARFBUZZ}/hb-set.cc \
        $${PATH_HARFBUZZ}/hb-shape.cc \
        $${PATH_HARFBUZZ}/hb-shape-plan.cc \
        $${PATH_HARFBUZZ}/hb-shaper.cc \
        $${PATH_HARFBUZZ}/hb-unicode.cc \
        $${PATH_HARFBUZZ}/hb-warning.cc


# harfbuzz opentype
SOURCES += \
        $${PATH_HARFBUZZ}/hb-ot-font.cc \
        $${PATH_HARFBUZZ}/hb-ot-layout.cc \
        $${PATH_HARFBUZZ}/hb-ot-map.cc \
        $${PATH_HARFBUZZ}/hb-ot-shape.cc \
        $${PATH_HARFBUZZ}/hb-ot-shape-complex-arabic.cc \
        $${PATH_HARFBUZZ}/hb-ot-shape-complex-default.cc \
        $${PATH_HARFBUZZ}/hb-ot-shape-complex-hangul.cc \
        $${PATH_HARFBUZZ}/hb-ot-shape-complex-hebrew.cc \
        $${PATH_HARFBUZZ}/hb-ot-shape-complex-indic.cc \
        $${PATH_HARFBUZZ}/hb-ot-shape-complex-indic-table.cc \
        $${PATH_HARFBUZZ}/hb-ot-shape-complex-myanmar.cc \
        $${PATH_HARFBUZZ}/hb-ot-shape-complex-thai.cc \
        $${PATH_HARFBUZZ}/hb-ot-shape-complex-tibetan.cc \
        $${PATH_HARFBUZZ}/hb-ot-shape-complex-use.cc \
        $${PATH_HARFBUZZ}/hb-ot-shape-complex-use-table.cc \
        $${PATH_HARFBUZZ}/hb-ot-shape-normalize.cc \
        $${PATH_HARFBUZZ}/hb-ot-shape-fallback.cc


# harfbuzz-ft
SOURCES += \
    $${PATH_HARFBUZZ}/hb-ft.cc


# harfbuzz-ucdn
SOURCES += \
    $${PATH_HARFBUZZ}/hb-ucdn.cc \
    $${PATH_HARFBUZZ_UCDN}/ucdn.c

